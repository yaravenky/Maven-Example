pipeline {

 agent any 
     stages {
     
            stage ('SCM checkout') {
                  steps {
                    git 'https://github.com/chaitanyapratap19/maven-project.git'

                  }
            
            }
            
            
            stage ('Maven compile') {
            agent {label 'maven'}
                  steps {
                    withMaven(jdk: 'JAVA_HOME', maven: 'MAVEN_HOME') {
                        sh 'mvn compile'
                   }

                  }
            
            }
            
            
             stage ('Maven test') {
                  steps {
                    withMaven(jdk: 'JAVA_HOME', maven: 'MAVEN_HOME') {
                        sh 'mvn test'
                   }

                  }
            
            }
            
            
            stage ('Maven Package') {
                  steps {
                    withMaven(jdk: 'JAVA_HOME', maven: 'MAVEN_HOME') {
                        sh 'mvn package'
                   }

                  }
            
            }
            
            
            
            stage ('Maven Install') {
                  steps {
                    withMaven(jdk: 'JAVA_HOME', maven: 'MAVEN_HOME') {
                        sh 'mvn clean install'
                   }

                  }
            
            }
            
            
            stage ('build && SonarQube analysis') {
                  steps {
                          withSonarQubeEnv(credentialsId: 'sonar') {
                                  // some block                                 
                                  
                                  withMaven(jdk: 'JAVA_HOME', maven: 'MAVEN_HOME') {
                                    sh 'mvn clean package sonar:sonar'
                                   }
                          }

                  }
            
            }
            
            
            
            
            
            
            
            



     }


}
